define("admin/group_list",["jquery","zui","config/config","config/function","lib/cookie","lib/chosen.min","lib/zui.datagrid.min","lib/zui.board.min"],function(require,exports,module){"use strict";var g=require("jquery");require("zui");var a=require("config/config"),o=require("config/function");require("lib/cookie");require("lib/chosen.min"),require("lib/zui.datagrid.min"),require("lib/zui.board.min");var t={init:function(){e(),s(),d(),u(),f(),v(),x(),k(),E(),R()}},e=function(){r(1e3,i)},r=function(t,i){var s={page:1,rows:t=t||0};g.ajax({type:"GET",url:a.REQUEST_URL.GROUP_LIST,dataType:"json",data:s,xhrFields:{withCredentials:!0},crossDomain:!0,success:function(t){if(console.log(t),0==t.status&&o.show_error_tip(t.info),t.records&&t.records>s.rows){var e=s.rows+=1e3;return r(e,i),!1}if(null==t.rows||""==t.rows)o.show_error_tip("沒有資料"),g.isFunction(i)&&i(t);else if(g.isFunction(i)){o.show_chosen([{key:"Id",value:"ID"},{key:"GroupName",value:"管理員組名稱"},{key:"Status",value:"狀態"},{key:"GroupInfo",value:"組描述"}]),i(t)}}})},n=function(t,i){var s={page:1,rows:t=t||0};g.ajax({type:"GET",url:a.REQUEST_URL.GROUP_LIST,dataType:"json",data:s,xhrFields:{withCredentials:!0},crossDomain:!0,success:function(t){if(t.records&&t.records>s.rows){var e=s.rows+=1e3;return n(e,i),!1}g.isFunction(i)&&i(l(t))}})},l=function(t){for(var e=t.rows||[],i=[],s=0;s<e.length;s++){var o=1==e[s].cell.Status?"啟用":"禁用",a={GroupName:e[s].cell.GroupName,Status:o,GroupInfo:e[s].cell.GroupInfo,option:'<div class="btn-group"><a data-id='+e[s].cell.Id+' href="/admin/group_edit" class="power btn edit">編輯</a><a data-id='+e[s].cell.Id+' href="/admin/group_delete" class="power btn del">刪除</a><a data-id='+e[s].cell.Id+' href="/admin/group_authority_edit" class="power btn auth">許可權</a></div>'};i.push(a)}return i},i=function(t){var e=l(t);g("#datagridPageExample").datagrid({dataSource:{cols:[{name:"GroupName",label:"管理員組名稱"},{name:"Status",label:"狀態"},{name:"GroupInfo",label:"組描述"},{name:"option",label:"操作",html:!0}],array:e},states:{pager:{page:1,recPerPage:14}},configs:{R0C0:{label:'<div id="checkAll" class="checkbox-primary datagrid-checkbox"><label></label></div>',html:!0},C0:{label:'<div class="che checkbox-primary datagrid-checkbox"><label></label></div>',width:"38px",html:!0}},sortable:!0,height:"page"}),g("#datagridPageExample").on("onRender",function(t){g(".datagrid-row-cell").removeClass("active"),o.show_btn()})},s=function(){g(document).on("click",'[data-link="/admin/group_add"]',function(t){c()})},c=function(){new g.zui.ModalTrigger({width:"auto",height:"auto",className:"in_auto",title:"新增管理員組",custom:'<div class="input-control has-label-left-lg"><input id="groupNameInput" type="text" class="form-control" placeholder=""><label for="groupNameInput" class="input-control-label-left text-right">管理員組名稱</label></div><div class="input-control has-label-left-lg"><input id="groupInfoInput" type="text" class="form-control" placeholder=""><label for="groupinfoInput" class="input-control-label-left text-right">組描述</label></div><div class="switch"><input id="groupCheckInput" type="checkbox"><label>啟用</label></div><button id="groupAddButton" class="btn btn-block btn-primary disabled up" type="button">新增</button>',backdrop:"static"}).show()},d=function(){g(document).on("click","#groupAddButton",function(){g("#groupAddButton").addClass("disabled"),h(o.show_success_tip,o.show_error_tip)})},h=function(e,i){var t={groupName:g("#groupNameInput").val(),groupInfo:g("#groupInfoInput").val(),status:1==g("#groupCheckInput").prop("checked")?1:0};g.ajax({type:"POST",url:a.REQUEST_URL.GROUP_ADD,dataType:"json",data:t,xhrFields:{withCredentials:!0},crossDomain:!0,success:function(t){!0===t.status?(g.isFunction(e)&&e(t.info),g("#triggerModal").modal("hide"),n(1e3,o.change_page)):g.isFunction(i)&&(i(t.info),g("#groupAddButton").removeClass("disabled"))}})},u=function(){g(document).on("click",".edit",function(t){t.stopPropagation();var e=g(this).attr("data-id");p(e,_,o.show_error_tip)})},p=function(t,e,i){var s={groupId:t};g.ajax({type:"GET",url:a.REQUEST_URL.GET_GROUP_INFO,dataType:"json",data:s,xhrFields:{withCredentials:!0},crossDomain:!0,success:function(t){!0===t.status?g.isFunction(e)&&e(t):g.errorFunction(e)&&i(t.info)}})},_=function(t){var e=t.data,i=1==e.Status?"checked":"",s='<div class="input-control has-label-left-lg"><input id="groupNameInput" type="text" class="form-control" value='+e.GroupName+' placeholder=""><label for="groupNameInput" class="input-control-label-left text-right">管理員組名稱</label></div><div class="input-control has-label-left-lg"><input id="groupInfoInput" type="text" class="form-control" value='+e.GroupInfo+' placeholder=""><label for="groupinfoInput" class="input-control-label-left text-right">組描述</label></div><div class="switch"><input id="groupCheckInput" type="checkbox" '+i+'><label>啟用</label></div><button id="groupEditButton" data-id='+e.Id+' class="btn btn-block btn-primary up" type="button">儲存</button>';new g.zui.ModalTrigger({width:"auto",height:"auto",className:"in_auto",title:"編輯管理員組",custom:s,backdrop:"static"}).show()},f=function(){g(document).on("click","#groupEditButton",function(){g("#groupEditButton").addClass("disabled");var t=g(this).attr("data-id");m(t,o.show_success_tip,o.show_error_tip)})},m=function(t,e,i){var s={groupId:t,groupName:g("#groupNameInput").val(),groupInfo:g("#groupInfoInput").val(),status:1==g("#groupCheckInput").prop("checked")?1:0};g.ajax({type:"POST",url:a.REQUEST_URL.GROUP_EDIT,dataType:"json",data:s,xhrFields:{withCredentials:!0},crossDomain:!0,success:function(t){!0===t.status?(g.isFunction(e)&&e(t.info),g("#triggerModal").modal("hide"),n(1e3,o.change_page)):g.isFunction(i)&&(i(t.info),g("#groupEditButton").removeClass("disabled"))}})},v=function(){g(document).on("click",".del",function(t){t.stopPropagation();var e=g(this).attr("data-id");y(e)}),b()},b=function(){g(document).on("click","#confirm",function(){g("#confirm").addClass("disabled");var t=g(this).attr("data-id");w(t,o.show_success_tip,o.show_error_tip)}),g(document).on("click","#cancel",function(){g("#triggerModal").modal("hide")})},y=function(t){var e='<h4>確認要刪除嗎?</h4><hr/><button type="button" data-id='+t+' id="confirm" class="btn btn-block btn-primary">確定</button><button type="button" id="cancel" class="btn btn-block btn-primary">取消</button>';new g.zui.ModalTrigger({width:"300px",height:"auto",className:"in_auto",title:"刪除管理員組",custom:e,backdrop:"static"}).show()},w=function(t,e,i){var s={idString:t};g.ajax({type:"GET",url:a.REQUEST_URL.GROUP_DELETE,dataType:"json",data:s,xhrFields:{withCredentials:!0},crossDomain:!0,success:function(t){!0===t.status?(g.isFunction(e)&&e(t.info),g("#triggerModal").modal("hide"),n(1e3,o.change_page)):g.isFunction(i)&&(i(t.info),g("#triggerModal").modal("hide"))}})},x=function(){g(document).on("click",'[data-link="/admin/group_delete"]:not(".del")',function(t){C()}),g(document).on("click","#continue",function(){g("#continue").addClass("disabled");for(var t=g(".che.checked").parents(".datagrid-row").find(".del"),e=[],i=0;i<t.length;i++)e.push(parseInt(t[i].getAttribute("data-id")));w(e.toString(),o.show_success_tip,o.show_error_tip)}),g(document).on("click","#cancel",function(t){g("#triggerModal").modal("hide")})},C=function(){new g.zui.ModalTrigger({width:"300px",height:"auto",className:"in_auto",title:"刪除管理員組",custom:'<h4>確認要刪除所選的管理組嗎?</h4><hr/><button type="button" id="continue" class="btn btn-block btn-primary">確定</button><button type="button" id="cancel" class="btn btn-block btn-primary">取消</button>',backdrop:"static"}).show()},k=function(){g(document).on("click",".auth",function(t){t.stopPropagation();var e=g(this).attr("data-id");T(e,S,o.show_error_tip)})},T=function(e,i,s){var t={groupId:e};g.ajax({type:"GET",url:a.REQUEST_URL.JQ_GET_DATA,dataType:"json",data:t,xhrFields:{withCredentials:!0},crossDomain:!0,success:function(t){!0===t.status?g.isFunction(i)&&i(t,e):g.isFunction(s)&&s(t.info)}})};function S(t,e){var i='<div class="boards" id="myBoards" style="height:500px;overflow: scroll;position:relative"><div class="board panel"><div class="panel-heading" style="position:fixed;width:248px;height:37px"><strong>已啟用</strong></div><div class="panel-body"><div class="board-list" id="open" style="margin-top:37px"></div></div></div><div class="board panel"><div class="panel-heading" style="position:fixed;width:248px;height:37px"><strong>未啟用</strong></div><div class="panel-body"><div class="board-list" id="close" style="margin-top:37px"></div></div></div></div><button id="editButton" data-id='+e+' class="btn btn-primary btn-block" type="button">提交</button>';new g.zui.ModalTrigger({width:"auto",height:"auto",className:"in_auto",title:"編輯管理員組許可權",custom:i,backdrop:"static"}).show(),I(t)}var I=function(t){var e=t.data,i=e.groupAllPerm,s=e.groupPerm,o=[],a=[],r=[],n=[];for(var l in i)o.push(i[l].action);for(var c=0;c<o.length;c++)for(var d=0;d<o[c].length;d++){var h={Id:o[c][d].Id,ActionName:o[c][d].ActionName};r.push(h)}for(var l in s)a.push(s[l].action);for(c=0;c<a.length;c++)for(d=0;d<a[c].length;d++){var u={Id:a[c][d].Id,ActionName:a[c][d].ActionName};n.push(u)}var p=D(n,r),_="";for(c=0;c<p.length;c++)_+="<div data-id="+p[c].Id+' class="board-item">'+p[c].ActionName+"</div>";g("#close").html(_);var f="";for(c=0;c<n.length;c++)f+="<div data-id="+n[c].Id+' class="board-item">'+n[c].ActionName+"</div>";g("#open").html(f),g("#myBoards").boards({drop:function(t){},lang:"zh_tw"}),g(document).on("click",'#open .board-item:not(".board-item-shadow"):not(".board-item-empty")',function(){g("#close").append(g(this))}),g(document).on("click",'#close .board-item:not(".board-item-shadow"):not(".board-item-empty")',function(){g("#open").append(g(this))})},D=function(t,e){t.sort(function(t,e){return t.Id-e.Id}),e.sort(function(t,e){return t.Id-e.Id});for(var i=[],s=0;s<e.length;s++){for(var o=e[s],a=o.Id,r=!1,n=0;n<t.length;n++){if(t[n].Id==a){r=!0;break}}r||i.push(o)}return i},E=function(){g(document).on("click","#editButton",function(){g("#editButton").addClass("disabled");for(var t=g(this).attr("data-id"),e=g('#open .board-item:not(".board-item-shadow"):not(".board-item-empty")'),i=[],s=0;s<e.length;s++)i.push(e[s].getAttribute("data-id"));M(t,i.toString(),o.show_success_tip,o.show_error_tip)})},M=function(t,e,i,s){var o={groupId:t,idString:e};g.ajax({type:"GET",url:a.REQUEST_URL.GROUP_AUTHORITY_EIDT,dataType:"json",data:o,xhrFields:{withCredentials:!0},crossDomain:!0,success:function(t){!0===t.status?(g.isFunction(i)&&i(t.info),g("#triggerModal").modal("hide")):(g.isFunction(s)&&s(t.info),g("#editButton").removeClass("disabled"))}})},R=function(){g(document).on("click",".search-button",function(){o.search_data(a.REQUEST_URL.GROUP_LIST,1e3,l)})};module.exports=t}),define("config/config",[],function(require,exports,module){"use strict";var t,e,i,s,o=seajs.data.vars._DEVELOPER;switch(seajs.data.vars._ENV){case 0:t=".i7391.com/",i="1000004",s="http://manageweb.i7391.com/",e="http://api-tools.i7391.com/";break;case-1:switch(t=".7391test.com/",o){case"qiujm":e="http://tools.lik.7391test.com/",i="1000011",s="http://manageweb.qiujm.7391test.com/";break;case"lik":e="http://tools.lik.7391test.com/",i="1000002",s="http://manageweb.lik.7391test.com/"}break;case-2:t=".7391test.com/",i="1000005",s="http://manageweb.7391test.com/",e="http://api-tools.7391test.com/"}console.log(e),exports.WORK_WECHAT_AGENTID=i,exports.WORK_WECHAT_RETURN_URL=s+"login_cb.html",exports.DOMAIN_SITE=t.slice,exports.API_TOOLS_SITE=e,exports.REQUEST_URL={LOGIN:e+"passport/work_wechat_callback.html",LOGOUT:e+"passport/logout.html",UPLOAD:e+"i7391_CMS/common/upload.html",MENU_LIST:e+"common/get_menu_list.html",GROUP_LIST:e+"admin/group_list.html",GROUP_ADD:e+"admin/group_add.html",GROUP_EDIT:e+"admin/group_edit.html",GROUP_DELETE:e+"admin/group_delete.html",GET_GROUP_INFO:e+"admin/group_edit.html?action=getGroupInfo",JQ_GET_DATA:e+"admin/group_authority_edit.html?action=jqGetData",GROUP_AUTHORITY_EIDT:e+"admin/group_authority_edit.html",ADMIN_LIST:e+"admin/admin_list.html",ADMIN_ADD:e+"admin/admin_add.html",ADMIN_EDIT:e+"admin/admin_edit.html",ADMIN_DELETE:e+"admin/admin_delete.html",ADMIN_WX_BIND:e+"wxqr/admin_bind.html",ADMIN_WX_UNBIND:e+"admin/wx_unbind.html",GET_ADMIN_INFO:e+"admin/admin_edit.html?action=getAdminInfo",GET_GROUP_LIST:e+"admin/admin_add.html?action=getGroupList",BANNER_LOGIN_LIST:e+"i7391_CMS/banner_pc/banner_login_list.html",BANNER_LOGIN_ADD:e+"i7391_CMS/banner_pc/banner_login_add.html",BANNER_LOGIN_EDIT:e+"i7391_CMS/banner_pc/banner_login_edit.html",BANNER_LOGIN_DELETE:e+"i7391_CMS/banner_pc/banner_login_delete.html",GET_BANNER_INFO:e+"i7391_CMS/banner_pc/banner_login_edit.html?action=getBannerInfo",BANNER_LOGIN_FOOTER_LIST:e+"i7391_CMS/banner_pc/banner_login_footer_list.html",BANNER_LOGIN_FOOTER_ADD:e+"/i7391_CMS/banner_pc/banner_login_footer_add.html",BANNER_LOGIN_FOOTER_EDIT:e+"/i7391_CMS/banner_pc/banner_login_footer_edit.html",BANNER_LOGIN_FOOTER_DELETE:e+"/i7391_CMS/banner_pc/banner_login_footer_delete.html",GET_FOOTER_INFO:e+"i7391_CMS/banner_pc/banner_login_footer_edit.html?action=getBannerInfo",CAROUSEL_LIST:e+"i7391_CMS/carousel/carousel_list.html",CAROUSEL_ADD:e+"i7391_CMS/carousel/carousel_add.html",CAROUSEL_EDIT:e+"i7391_CMS/carousel/carousel_edit.html",CAROUSEL_DELETE:e+"i7391_CMS/carousel/carousel_delete.html",GET_CAROUSEL_INFO:e+"i7391_CMS/carousel/carousel_edit.html?action=getCarouselInfo",GAME_LIST:e+"i7391_CMS/game/game_list.html",GAME_ADD:e+"i7391_CMS/game/game_add.html",GAME_EDIT:e+"i7391_CMS/game/game_edit.html",GAME_DELETE:e+"i7391_CMS/game/game_detele.html",GET_GAME_INFO:e+"i7391_CMS/game/game_edit.html?action=getGameInfo",POINTCARD_LIST:e+"i7391_CMS/pointcard/pointcard_list.html",POINTCARD_ADD:e+"i7391_CMS/pointcard/pointcard_add.html",POINTCARD_EDIT:e+"i7391_CMS/pointcard/pointcard_edit.html",POINTCARD_DELETE:e+"i7391_CMS/pointcard/pointcard_delete.html",GET_POINTCARD_INFO:e+"i7391_CMS/pointcard/pointcard_edit.html?action=getPointcardInfo",MOBILEGAME_LIST:e+"i7391_CMS/mobilegame/mobilegame_list.html",MOBILEGAME_ADD:e+"i7391_CMS/mobilegame/mobilegame_add.html",MOBILEGAME_EDIT:e+"i7391_CMS/mobilegame/mobilegame_edit.html",MOBILEGAME_DELETE:e+"i7391_CMS/mobilegame/mobilegame_delete.html",GET_MOBILEGAME_INFO:e+"i7391_CMS/mobilegame/mobilegame_edit.html?action=getMobileGameInfo",GOODS_LIST:e+"i7391_CMS/goods/goods_list.html",GOODS_ADD:e+"i7391_CMS/goods/goods_add.html",GOODS_EDIT:e+"i7391_CMS/goods/goods_edit.html",GOODS_DELETE:e+"i7391_CMS/goods/goods_detele.html",GET_GOODS_INFO:e+"i7391_CMS/goods/goods_edit.html?action=getGoodsInfo",GOODS_PC_LIST:e+"i7391_CMS/goods_pc/goods_list.html",GOODS_PC_ADD:e+"i7391_CMS/goods_pc/goods_add.html",GOODS_PC_EDIT:e+"i7391_CMS/goods_pc/goods_edit.html",GOODS_PC_DELETE:e+"i7391_CMS/goods_pc/goods_detele.html",GET_GOODS_PC_INFO:e+"i7391_CMS/goods_pc/goods_edit.html?action=getGoodsInfo",GET_RECORD:e+"8591/contrast/game_contrast.html?action=getRecord",GAME_CONTRAST:e+"8591/contrast/game_contrast.html",GET_ALLGAME_DATA:e+"i7391_API/getdata/get_allgame_data.html",GET_GAMETYPE_DATA:e+"i7391_API/getdata/get_gametype_data",GET_RATE:e+"i7391_API/getdata/get_rate.html",GET_CARD_CATEGORY:e+"i7391_API/getdata/get_card_category.html",GET_CARD_POINT:e+"i7391_API/getdata/get_card_point.html",CLEAN_DATA:"http://117.27.250.72:8081/_clean/res.php"}}),define("config/function",["jquery","zui","config/config","lib/cookie"],function(require,exports,module){"use strict";var a=require("jquery");require("zui");var t=require("config/config"),r=require("lib/cookie");a.ajaxSetup({error:function(t,e,i){var s="介面出錯: "+t.status;s+="<br /> 介面: "+this.url,s+="<br /> 方式: "+this.type,s+="<br /> 資料: "+this.data,o.show(s)},beforeSend:function(t){a("#ajax_loading").removeClass("hidden").addClass("show")},complete:function(t,e){a("#ajax_loading").removeClass("show").addClass("hidden")}}),a(document).on("click","a",function(t){t.preventDefault()});exports.show_btn=function(){for(var t=a(".power"),e=0;e<t.length;e++){var i="/"==t[e].getAttribute("data-link")?t[e].getAttribute("data-link"):"/"+t[e].getAttribute("data-link");r(i)==i?a('[data-link="'+i+'"]').removeClass("hidden"):a('[data-link="'+i+'"]').remove()}},a(document).on("click",'.datagrid-row:not(".datagrid-row-head"):not("#triggerModal .datagrid-row")',function(){0==a(this).find(".che").hasClass("checked")?(a(this).find(".che").addClass("checked"),a(this).addClass("active")):(a(this).find(".che").removeClass("checked"),a(this).removeClass("active")),a(".che").length==a(".che.checked").length?a("#checkAll").addClass("checked"):a("#checkAll").removeClass("checked")}),a(document).on("click",".datagrid-row-head .datagrid-cell-index",function(){0==a(this).find("#checkAll").hasClass("checked")?(a(this).find("#checkAll").addClass("checked"),a(".che").addClass("checked"),a(".che").parents(".datagrid-row").addClass("active")):(a(this).find("#checkAll").removeClass("checked"),a(".che").removeClass("checked"),a(".che").parents(".datagrid-row").removeClass("active"))}),a(document).keydown(function(t){switch(t.keyCode){case 13:case 32:return!1}}),a(document).on("input porpertychange change",'input[type="text"]',function(t){a(this).tooltip("destroy");var e=a('input[type="text"]');""==a(this).val()&&a(this).tooltip("show","請填寫"+a(this).next().html());for(var i=0;i<e.length;i++){if(""==e[i].value){a(".up").addClass("disabled");break}a(".up").removeClass("disabled")}});exports.get_search_data=function(t,e,i){a(document).on("click",".search-button",function(){n(t,e,i)})};var n=function(i,t,s){var o={page:1,rows:t,searchField:a(".chosen-select").val(),searchOper:"cn",searchString:a("input.search-control").val(),_search:!0};a.ajax({type:"GET",url:i,dataType:"json",data:o,xhrFields:{withCredentials:!0},crossDomain:!0,success:function(t){if(t.records&&t.records>o.rows){var e=o.rows+=1e3;return n(i,e,s),!1}a.isFunction(s)&&l(s(t))}})};exports.search_data=n;var l=function(t){var e=parseInt(a('li[class="active"] .pager-item').html()),i=a("#datagridPageExample").data("zui.datagrid");i.setDataSource(t),i.render(),a("#datagridPageExample").on("onRender",function(t){i.setPager(e||1)})};exports.change_page=l;exports.show_picture_upload=function(){return'<div id="tableUploader" class="uploader"><div class="uploader-message text-center"><div class="content"></div><button type="button" class="close">×</button></div><table class="table table-bordered"><thead><tr><th colspan="2">檔名</th><th style="width: 100px">大小</th><th style="width: 160px; text-align: center;">狀態/操作</th></tr></thead><tbody class="uploader-files"><tr class="file template"><td style="width: 38px; padding: 3px"><div class="file-icon"></div></td><td style="padding: 0"><div style="position: relative; padding: 8px;"><strong class="file-name"></strong><div class="file-progress-bar"></div></div></td><td><span class="file-size text-muted"></span></td><td class="actions text-right" style="padding: 0 4px;"><div class="file-status" data-toggle="tooltip" style="margin: 8px;"><i class="icon"></i> <span class="text"></span></div><a data-toggle="tooltip" class="btn btn-link btn-download-file" target="_blank"><i class="icon icon-download-alt"></i></a><button type="button" data-toggle="tooltip" class="btn btn-link btn-reset-file" title="Repeat"><i class="icon icon-repeat"></i></button><button type="button" data-toggle="tooltip" class="btn btn-link btn-rename-file" title="Rename"><i class="icon icon-pencil"></i></button><button type="button" data-toggle="tooltip" title="Remove" class="btn btn-link btn-delete-file"><i class="icon icon-trash text-danger"></i></button></td></tr></tbody><tfoot><tr><td colspan="4" style="padding: 4px 0"><div style="position: relative;"><div class="uploader-status pull-right text-muted" style="margin-top: 5px;"></div><button type="button" class="btn btn-link uploader-btn-browse"><i class="icon icon-plus"></i> 選擇檔案</button><button type="button" class="btn btn-link uploader-btn-start"><i class="icon icon-cloud-upload"></i> 開始上傳</button></div></td></tr></tfoot></table></div>'};exports.show_upload_options=function(){a("#tableUploader").uploader({url:t.REQUEST_URL.UPLOAD,lang:"zh_tw",filters:{mime_types:[{title:"圖片",extensions:"jpg,gif,png"}]},limitFilesCount:1,deleteActionOnDone:function(t,e){e()},onFileUploaded:function(t,e){var i=JSON.parse(e.response);a("#imgUrlInput").val(i.data)}})};exports.show_chosen=function(t){for(var e="<option value=''></option>",i=0;i<t.length;i++)e+="<option value="+t[i].key+">"+t[i].value+"</option>";a("select.chosen-select").html(e),a("select.chosen-select").chosen({lang:"zh_cn",no_results_text:"沒有找到",disable_search_threshold:10,search_contains:!0})};exports.show_picture_tooltip=function(){a(document).on("mouseover",".pic-show:not(:eq(0))",function(){a(this).tooltip("destroy");var t=a(this).html(),e=/^\/\//;!0===e.test(t)&&(t=t.replace(e,"http://"));var i="<img src="+t+' class="img-rounded">';a('[data-toggle="tooltip"]').tooltip({container:"#datagridPageExample",placement:"right",html:!0,title:i}),a(this).tooltip("show",i)})};var o=new a.zui.Messager("",{type:"danger",icon:"exclamation-sign",cssClass:"my-messager",contentClass:"my-messager-content",placement:"center",time:!0===seajs.data.debug?1e4:4e3});exports.get_user_i7391_cookie=function(t){var e=[],i=r("User_Cookie_Name");if(null===i||""===i)return!1;var s=i.split("&");for(var o in s){var a=s[o].split("=");e[a[0]]=a[1]}return void 0!==e[t]&&e[t]},exports.getUrlParam=function(t){var e=window.location.hash.match(new RegExp("(?:#|&)"+t+"=([^&]*)(&|$)"));return(e?decodeURIComponent(e[1]):"")||function(t,e){e||(e=window.location.href);t=t.replace(/[\[\]]/g,"\\$&");var i=new RegExp("[?&]"+t+"(=([^&#]*)|&|#|$)").exec(e);return i?i[2]?decodeURIComponent(i[2].replace(/\+/g," ")):"":null}(t)};exports.show_error_tip=function(t){var e=t;new a.zui.Messager({type:"danger",time:2e3,close:!1}).show(e)};exports.show_success_tip=function(t){var e=t;new a.zui.Messager({type:"success",time:2e3,close:!1}).show(e)};exports.delete_all_cookie=function(){for(var t=document.cookie.split(";"),e=0;e<t.length;e++){var i=-1<(o=(s=t[e]).indexOf("="))?s.substr(0,o):s;document.cookie=i+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/"}if(0<t.length)for(e=0;e<t.length;e++){i=-1<(o=(s=t[e]).indexOf("="))?s.substr(0,o):s;var s,o,a=location.host.substr(location.host.indexOf("."));document.cookie=i+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/; domain="+a}}}),define("lib/cookie",["jquery"],function(require,exports,module){"use strict";var u=require("jquery");module.exports=function(t,e,i){if(void 0===e){var s=null;if(document.cookie&&""!==document.cookie)for(var o=document.cookie.split(";"),a=0;a<o.length;a++){var r=u.trim(o[a]);if(r.substring(0,t.length+1)==t+"="){s=decodeURIComponent(r.substring(t.length+1));break}}return s}i=i||{},null===e&&(e="",i.expires=-1);var n,l="";i.expires&&("number"==typeof i.expires||i.expires.toUTCString)&&("number"==typeof i.expires?(n=new Date).setTime(n.getTime()+24*i.expires*60*60*1e3):n=i.expires,l="; expires="+n.toUTCString());var c=i.path?"; path="+i.path:"",d=i.domain?"; domain="+i.domain:"",h=i.secure?"; secure":"";document.cookie=[t,"=",encodeURIComponent(e),l,c,d,h].join("")}}),function(t,e){"object"==typeof exports?module.exports=e():"function"==typeof define&&(define.amd||define.cmd)?define("lib/chosen.min",[],e):t.eventUtil=e()}(this,function(){(function(){var l,i,o,r,a={}.hasOwnProperty,s={zh_cn:{no_results_text:"没有找到"},zh_tw:{no_results_text:"沒有找到"},en:{no_results_text:"No results match"}};(r=function(){function t(){this.options_index=0,this.parsed=[]}return t.prototype.add_node=function(t){return"OPTGROUP"===t.nodeName.toUpperCase()?this.add_group(t):this.add_option(t)},t.prototype.add_group=function(t){var e,i,s,o,a,r;for(e=this.parsed.length,this.parsed.push({array_index:e,group:!0,label:this.escapeExpression(t.label),children:0,disabled:t.disabled,title:t.title,search_keys:l.trim(t.getAttribute("data-keys")||"").replace(/,/g," ")}),r=[],s=0,o=(a=t.childNodes).length;s<o;s++)i=a[s],r.push(this.add_option(i,e,t.disabled));return r},t.prototype.add_option=function(t,e,i){if("OPTION"===t.nodeName.toUpperCase())return""!==t.text?(null!=e&&(this.parsed[e].children+=1),this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,value:t.value,text:t.text,title:t.title,html:t.innerHTML,selected:t.selected,disabled:!0===i?i:t.disabled,group_array_index:e,classes:t.className,style:t.style.cssText,search_keys:(l.trim(t.getAttribute("data-keys")||"")+t.value).replace(/,/," ")})):this.parsed.push({array_index:this.parsed.length,options_index:this.options_index,empty:!0}),this.options_index+=1},t.prototype.escapeExpression=function(t){var e,i;return null==t||!1===t?"":/[\&\<\>\"\'\`]/.test(t)?(e={"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},i=/&(?!\w+;)|[\<\>\"\'\`]/g,t.replace(i,function(t){return e[t]||"&amp;"})):t},t}()).select_to_array=function(t){var e,i,s,o,a;for(i=new r,s=0,o=(a=t.childNodes).length;s<o;s++)e=a[s],i.add_node(e);return i.parsed},i=function(){function i(t,e){this.form_field=t,this.options=null!=e?e:{},i.browser_is_supported()&&(this.lang=s[this.options.lang||(l.zui.clientLang?l.zui.clientLang():"zh_cn")],this.is_multiple=this.form_field.multiple,this.set_default_text(),this.set_default_values(),this.setup(),this.set_up_html(),this.register_observers())}return i.prototype.set_default_values=function(){var e=this;return this.click_test_action=function(t){return e.test_active_click(t)},this.activate_action=function(t){return e.activate_field(t)},this.active_field=!1,this.mouse_on_container=!1,this.results_showing=!1,this.result_highlighted=null,this.allow_single_deselect=null!=this.options.allow_single_deselect&&null!=this.form_field.options[0]&&""===this.form_field.options[0].text&&this.options.allow_single_deselect,this.disable_search_threshold=this.options.disable_search_threshold||0,this.disable_search=this.options.disable_search||!1,this.enable_split_word_search=null==this.options.enable_split_word_search||this.options.enable_split_word_search,this.group_search=null==this.options.group_search||this.options.group_search,this.search_contains=this.options.search_contains||!1,this.single_backstroke_delete=null==this.options.single_backstroke_delete||this.options.single_backstroke_delete,this.max_selected_options=this.options.max_selected_options||1/0,this.drop_direction=this.options.drop_direction||"auto",this.middle_highlight=this.options.middle_highlight,this.inherit_select_classes=this.options.inherit_select_classes||!1,this.display_selected_options=null==this.options.display_selected_options||this.options.display_selected_options,this.display_disabled_options=null==this.options.display_disabled_options||this.options.display_disabled_options},i.prototype.set_default_text=function(){return this.form_field.getAttribute("data-placeholder")?this.default_text=this.form_field.getAttribute("data-placeholder"):this.is_multiple?this.default_text=this.options.placeholder_text_multiple||this.options.placeholder_text||i.default_multiple_text:this.default_text=this.options.placeholder_text_single||this.options.placeholder_text||i.default_single_text,this.results_none_found=this.form_field.getAttribute("data-no_results_text")||this.options.no_results_text||this.lang.no_results_text||i.default_no_result_text},i.prototype.mouse_enter=function(){return this.mouse_on_container=!0},i.prototype.mouse_leave=function(){return this.mouse_on_container=!1},i.prototype.input_focus=function(t){var e=this;if(this.is_multiple){if(!this.active_field)return setTimeout(function(){return e.container_mousedown()},50)}else if(!this.active_field)return this.activate_field()},i.prototype.input_blur=function(t){var e=this;if(!this.mouse_on_container)return this.active_field=!1,setTimeout(function(){return e.blur_test()},100)},i.prototype.results_option_build=function(t){var e,i,s,o,a;for(e="",s=0,o=(a=this.results_data).length;s<o;s++)e+=(i=a[s]).group?this.result_add_group(i):this.result_add_option(i),(null!=t?t.first:void 0)&&(i.selected&&this.is_multiple?this.choice_build(i):i.selected&&!this.is_multiple&&this.single_set_selected_text(i.text));return e},i.prototype.result_add_option=function(t){var e,i;return t.search_match&&this.include_option_in_results(t)?(e=[],t.disabled||t.selected&&this.is_multiple||e.push("active-result"),!t.disabled||t.selected&&this.is_multiple||e.push("disabled-result"),t.selected&&e.push("result-selected"),null!=t.group_array_index&&e.push("group-option"),""!==t.classes&&e.push(t.classes),(i=document.createElement("li")).className=e.join(" "),i.style.cssText=t.style,i.title=t.title,i.setAttribute("data-option-array-index",t.array_index),i.innerHTML=t.search_text,this.outerHTML(i)):""},i.prototype.result_add_group=function(t){var e;return(t.search_match||t.group_match)&&0<t.active_options?((e=document.createElement("li")).className="group-result",e.title=t.title,e.innerHTML=t.search_text,this.outerHTML(e)):""},i.prototype.results_update_field=function(){if(this.set_default_text(),this.is_multiple||this.results_reset_cleanup(),this.result_clear_highlight(),this.results_build(),this.results_showing)return this.winnow_results()},i.prototype.reset_single_select_options=function(){var t,e,i,s,o;for(o=[],e=0,i=(s=this.results_data).length;e<i;e++)(t=s[e]).selected?o.push(t.selected=!1):o.push(void 0);return o},i.prototype.results_toggle=function(){return this.results_showing?this.results_hide():this.results_show()},i.prototype.results_search=function(t){return this.results_showing?this.winnow_results(1):this.results_show()},i.prototype.winnow_results=function(t){var e,i,s,o,a,r,n,l,c,d,h,u,p;for(this.no_results_clear(),a=0,e=(n=this.get_search_text()).replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),o=this.search_contains?"":"^",s=new RegExp(o+e,"i"),d=new RegExp(e,"i"),h=0,u=(p=this.results_data).length;h<u;h++)(i=p[h]).search_match=!1,r=null,this.include_option_in_results(i)&&(i.group&&(i.group_match=!1,i.active_options=0),null!=i.group_array_index&&this.results_data[i.group_array_index]&&(0===(r=this.results_data[i.group_array_index]).active_options&&r.search_match&&(a+=1),r.active_options+=1),i.group&&!this.group_search||(i.search_text=i.group?i.label:i.html,i.search_keys_match=this.search_string_match(i.search_keys,s),i.search_text_match=this.search_string_match(i.search_text,s),i.search_match=i.search_text_match||i.search_keys_match,i.search_match&&!i.group&&(a+=1),i.search_match?(i.search_text_match&&i.search_text.length?(l=i.search_text.search(d),c=i.search_text.substr(0,l+n.length)+"</em>"+i.search_text.substr(l+n.length),i.search_text=c.substr(0,l)+"<em>"+c.substr(l)):i.search_keys_match&&i.search_keys.length&&(l=i.search_keys.search(d),c=i.search_keys.substr(0,l+n.length)+"</em>"+i.search_keys.substr(l+n.length),i.search_text+='&nbsp; <small style="opacity: 0.7">'+c.substr(0,l)+"<em>"+c.substr(l)+"</small>"),null!=r&&(r.group_match=!0)):null!=i.group_array_index&&this.results_data[i.group_array_index].search_match&&(i.search_match=!0)));return this.result_clear_highlight(),a<1&&n.length?(this.update_results_content(""),this.no_results(n)):(this.update_results_content(this.results_option_build()),this.winnow_results_set_highlight(t))},i.prototype.search_string_match=function(t,e){var i,s,o,a;if(e.test(t))return!0;if(this.enable_split_word_search&&(0<=t.indexOf(" ")||0===t.indexOf("["))&&(s=t.replace(/\[|\]/g,"").split(" ")).length)for(o=0,a=s.length;o<a;o++)if(i=s[o],e.test(i))return!0},i.prototype.choices_count=function(){var t,e,i,s;if(null!=this.selected_option_count)return this.selected_option_count;for(e=this.selected_option_count=0,i=(s=this.form_field.options).length;e<i;e++)(t=s[e]).selected&&""!=t.value&&(this.selected_option_count+=1);return this.selected_option_count},i.prototype.choices_click=function(t){if(t.preventDefault(),!this.results_showing&&!this.is_disabled)return this.results_show()},i.prototype.keyup_checker=function(t){var e,i;switch(e=null!=(i=t.which)?i:t.keyCode,this.search_field_scale(),e){case 8:if(this.is_multiple&&this.backstroke_length<1&&0<this.choices_count())return this.keydown_backstroke();if(!this.pending_backstroke)return this.result_clear_highlight(),this.results_search();break;case 13:if(t.preventDefault(),this.results_showing)return this.result_select(t);break;case 27:return this.results_showing&&this.results_hide(),!0;case 9:case 38:case 40:case 16:case 91:case 17:break;default:return this.results_search()}},i.prototype.clipboard_event_checker=function(t){var e=this;return setTimeout(function(){return e.results_search()},50)},i.prototype.container_width=function(){return null!=this.options.width?this.options.width:this.form_field.offsetWidth+"px"},i.prototype.include_option_in_results=function(t){return!(this.is_multiple&&!this.display_selected_options&&t.selected||!this.display_disabled_options&&t.disabled||t.empty)},i.prototype.search_results_touchstart=function(t){return this.touch_started=!0,this.search_results_mouseover(t)},i.prototype.search_results_touchmove=function(t){return this.touch_started=!1,this.search_results_mouseout(t)},i.prototype.search_results_touchend=function(t){if(this.touch_started)return this.search_results_mouseup(t)},i.prototype.outerHTML=function(t){var e;return t.outerHTML?t.outerHTML:((e=document.createElement("div")).appendChild(t),e.innerHTML)},i.browser_is_supported=function(){return"Microsoft Internet Explorer"===window.navigator.appName?8<=document.documentMode:!(/iP(od|hone)/i.test(window.navigator.userAgent)||/Android/i.test(window.navigator.userAgent)&&/Mobile/i.test(window.navigator.userAgent))},i.default_multiple_text="",i.default_single_text="",i.default_no_result_text="No results match",i}(),(l=jQuery).fn.extend({chosen:function(s){return i.browser_is_supported()?this.each(function(t){var e,i;i=(e=l(this)).data("chosen"),"destroy"===s&&i?i.destroy():i||e.data("chosen",new o(this,s))}):this}}),o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return function(t,e){function i(){this.constructor=t}for(var s in e)a.call(e,s)&&(t[s]=e[s]);i.prototype=e.prototype,t.prototype=new i,t.__super__=e.prototype}(e,i),e.prototype.setup=function(){return this.form_field_jq=l(this.form_field),this.current_selectedIndex=this.form_field.selectedIndex,this.is_rtl=this.form_field_jq.hasClass("chosen-rtl")},e.prototype.set_up_html=function(){var t,e;(t=["chosen-container"]).push("chosen-container-"+(this.is_multiple?"multi":"single")),this.inherit_select_classes&&this.form_field.className&&t.push(this.form_field.className),this.is_rtl&&t.push("chosen-rtl");var i=this.form_field.getAttribute("data-css-class");return i&&t.push(i),e={class:t.join(" "),style:"width: "+this.container_width()+";",title:this.form_field.title},this.form_field.id.length&&(e.id=this.form_field.id.replace(/[^\w]/g,"_")+"_chosen"),this.container=l("<div />",e),this.is_multiple?this.container.html('<ul class="chosen-choices"><li class="search-field"><input type="text" value="'+this.default_text+'" class="default" autocomplete="off" style="width:25px;" /></li></ul><div class="chosen-drop"><ul class="chosen-results"></ul></div>'):this.container.html('<a class="chosen-single chosen-default" tabindex="-1"><span>'+this.default_text+'</span><div><b></b></div></a><div class="chosen-drop"><div class="chosen-search"><input type="text" autocomplete="off" /></div><ul class="chosen-results"></ul></div>'),this.form_field_jq.hide().after(this.container),this.dropdown=this.container.find("div.chosen-drop").first(),this.search_field=this.container.find("input").first(),this.search_results=this.container.find("ul.chosen-results").first(),this.search_field_scale(),this.search_no_results=this.container.find("li.no-results").first(),this.is_multiple?(this.search_choices=this.container.find("ul.chosen-choices").first(),this.search_container=this.container.find("li.search-field").first()):(this.search_container=this.container.find("div.chosen-search").first(),this.selected_item=this.container.find(".chosen-single").first()),this.options.drop_width&&this.dropdown.css("width",this.options.drop_width).addClass("chosen-drop-size-limited"),this.results_build(),this.set_tab_index(),this.set_label_behavior(),this.form_field_jq.trigger("chosen:ready",{chosen:this})},e.prototype.register_observers=function(){var e=this;return this.container.bind("mousedown.chosen",function(t){e.container_mousedown(t)}),this.container.bind("mouseup.chosen",function(t){e.container_mouseup(t)}),this.container.bind("mouseenter.chosen",function(t){e.mouse_enter(t)}),this.container.bind("mouseleave.chosen",function(t){e.mouse_leave(t)}),this.search_results.bind("mouseup.chosen",function(t){e.search_results_mouseup(t)}),this.search_results.bind("mouseover.chosen",function(t){e.search_results_mouseover(t)}),this.search_results.bind("mouseout.chosen",function(t){e.search_results_mouseout(t)}),this.search_results.bind("mousewheel.chosen DOMMouseScroll.chosen",function(t){e.search_results_mousewheel(t)}),this.search_results.bind("touchstart.chosen",function(t){e.search_results_touchstart(t)}),this.search_results.bind("touchmove.chosen",function(t){e.search_results_touchmove(t)}),this.search_results.bind("touchend.chosen",function(t){e.search_results_touchend(t)}),this.form_field_jq.bind("chosen:updated.chosen",function(t){e.results_update_field(t)}),this.form_field_jq.bind("chosen:activate.chosen",function(t){e.activate_field(t)}),this.form_field_jq.bind("chosen:open.chosen",function(t){e.container_mousedown(t)}),this.form_field_jq.bind("chosen:close.chosen",function(t){e.input_blur(t)}),this.search_field.bind("blur.chosen",function(t){e.input_blur(t)}),this.search_field.bind("keyup.chosen",function(t){e.keyup_checker(t)}),this.search_field.bind("keydown.chosen",function(t){e.keydown_checker(t)}),this.search_field.bind("focus.chosen",function(t){e.input_focus(t)}),this.search_field.bind("cut.chosen",function(t){e.clipboard_event_checker(t)}),this.search_field.bind("paste.chosen",function(t){e.clipboard_event_checker(t)}),this.is_multiple?this.search_choices.bind("click.chosen",function(t){e.choices_click(t)}):this.container.bind("click.chosen",function(t){t.preventDefault()})},e.prototype.destroy=function(){return l(this.container[0].ownerDocument).unbind("click.chosen",this.click_test_action),this.search_field[0].tabIndex&&(this.form_field_jq[0].tabIndex=this.search_field[0].tabIndex),this.container.remove(),this.form_field_jq.removeData("chosen"),this.form_field_jq.show()},e.prototype.search_field_disabled=function(){return this.is_disabled=this.form_field_jq[0].disabled,this.is_disabled?(this.container.addClass("chosen-disabled"),this.search_field[0].disabled=!0,this.is_multiple||this.selected_item.unbind("focus.chosen",this.activate_action),this.close_field()):(this.container.removeClass("chosen-disabled"),this.search_field[0].disabled=!1,this.is_multiple?void 0:this.selected_item.bind("focus.chosen",this.activate_action))},e.prototype.container_mousedown=function(t){if(!this.is_disabled&&(t&&"mousedown"===t.type&&!this.results_showing&&t.preventDefault(),null==t||!l(t.target).hasClass("search-choice-close")))return this.active_field?this.is_multiple||!t||l(t.target)[0]!==this.selected_item[0]&&!l(t.target).parents("a.chosen-single").length||(t.preventDefault(),this.results_toggle()):(this.is_multiple&&this.search_field.val(""),l(this.container[0].ownerDocument).bind("click.chosen",this.click_test_action),this.results_show()),this.activate_field()},e.prototype.container_mouseup=function(t){if("ABBR"===t.target.nodeName&&!this.is_disabled)return this.results_reset(t)},e.prototype.search_results_mousewheel=function(t){var e;if(t.originalEvent&&(e=-t.originalEvent.wheelDelta||t.originalEvent.detail),null!=e)return t.preventDefault(),"DOMMouseScroll"===t.type&&(e*=40),this.search_results.scrollTop(e+this.search_results.scrollTop())},e.prototype.blur_test=function(t){if(!this.active_field&&this.container.hasClass("chosen-container-active"))return this.close_field()},e.prototype.close_field=function(){return l(this.container[0].ownerDocument).unbind("click.chosen",this.click_test_action),this.active_field=!1,this.results_hide(),this.container.removeClass("chosen-container-active"),this.clear_backstroke(),this.show_search_field_default(),this.search_field_scale()},e.prototype.activate_field=function(){this.container.addClass("chosen-container-active"),this.active_field=!0,this.search_field.val(this.search_field.val())},e.prototype.test_active_click=function(t){var e;return(e=l(t.target).closest(".chosen-container")).length&&this.container[0]===e[0]?this.active_field=!0:this.close_field()},e.prototype.results_build=function(){return this.parsing=!0,this.selected_option_count=null,this.results_data=r.select_to_array(this.form_field),this.is_multiple?this.search_choices.find("li.search-choice").remove():this.is_multiple||(this.single_set_selected_text(),this.disable_search||this.form_field.options.length<=this.disable_search_threshold?(this.search_field[0].readOnly=!0,this.container.addClass("chosen-container-single-nosearch")):(this.search_field[0].readOnly=!1,this.container.removeClass("chosen-container-single-nosearch"))),this.update_results_content(this.results_option_build({first:!0})),this.search_field_disabled(),this.show_search_field_default(),this.search_field_scale(),this.parsing=!1},e.prototype.result_do_highlight=function(t,e){var i,s,o,a,r,n,l=-1;t.length&&(this.result_clear_highlight(),this.result_highlight=t,this.result_highlight.addClass("highlighted"),o=parseInt(this.search_results.css("maxHeight"),10),n=this.result_highlight.outerHeight(),a=o+(r=this.search_results.scrollTop()),i=(s=this.result_highlight.position().top+this.search_results.scrollTop())+n,this.middle_highlight&&(e||"always"===this.middle_highlight||a<=i||s<r)?l=Math.min(s-n,Math.max(0,s-(o-n)/2)):a<=i?l=0<i-o?i-o:0:s<r&&(l=s),-1<l&&this.search_results.scrollTop(l))},e.prototype.result_clear_highlight=function(){return this.result_highlight&&this.result_highlight.removeClass("highlighted"),this.result_highlight=null},e.prototype.results_show=function(){if(this.is_multiple&&this.max_selected_options<=this.choices_count())return this.form_field_jq.trigger("chosen:maxselected",{chosen:this}),!1;this.container.addClass("chosen-with-drop"),this.results_showing=!0,this.search_field.focus(),this.search_field.val(this.search_field.val()),this.winnow_results(1);var t=this.drop_direction;if("auto"===t)if(this.drop_directionFixed)t=this.drop_directionFixed;else{var e=this.container.find(".chosen-drop");this.container.offset().top+e.outerHeight()+30>l(window).height()+l(window).scrollTop()&&(t="up"),this.drop_directionFixed=t}return this.container.toggleClass("chosen-up","up"===t),this.form_field_jq.trigger("chosen:showing_dropdown",{chosen:this})},e.prototype.update_results_content=function(t){return this.search_results.html(t)},e.prototype.results_hide=function(){return this.results_showing&&(this.result_clear_highlight(),this.container.removeClass("chosen-with-drop"),this.form_field_jq.trigger("chosen:hiding_dropdown",{chosen:this}),this.drop_directionFixed=0),this.results_showing=!1},e.prototype.set_tab_index=function(t){var e;if(this.form_field.tabIndex)return e=this.form_field.tabIndex,this.form_field.tabIndex=-1,this.search_field[0].tabIndex=e},e.prototype.set_label_behavior=function(){var e=this;if(this.form_field_label=this.form_field_jq.parents("label"),!this.form_field_label.length&&this.form_field.id.length&&(this.form_field_label=l("label[for='"+this.form_field.id+"']")),0<this.form_field_label.length)return this.form_field_label.bind("click.chosen",function(t){return e.is_multiple?e.container_mousedown(t):e.activate_field()})},e.prototype.show_search_field_default=function(){return this.is_multiple&&this.choices_count()<1&&!this.active_field?(this.search_field.val(this.default_text),this.search_field.addClass("default")):(this.search_field.val(""),this.search_field.removeClass("default"))},e.prototype.search_results_mouseup=function(t){var e;(e=l(t.target).hasClass("active-result")?l(t.target):l(t.target).parents(".active-result").first()).length&&(this.result_highlight=e,this.result_select(t))},e.prototype.search_results_mouseover=function(t){var e;if(e=l(t.target).hasClass("active-result")?l(t.target):l(t.target).parents(".active-result").first())return this.result_do_highlight(e)},e.prototype.search_results_mouseout=function(t){if(l(t.target).hasClass("active-result"))return this.result_clear_highlight()},e.prototype.choice_build=function(t){var e,i,s=this;return e=l("<li />",{class:"search-choice"}).html("<span title='"+t.html+"'>"+t.html+"</span>"),t.disabled?e.addClass("search-choice-disabled"):((i=l("<a />",{class:"search-choice-close","data-option-array-index":t.array_index})).bind("click.chosen",function(t){return s.choice_destroy_link_click(t)}),e.append(i)),this.search_container.before(e)},e.prototype.choice_destroy_link_click=function(t){if(t.preventDefault(),t.stopPropagation(),!this.is_disabled)return this.choice_destroy(l(t.target))},e.prototype.choice_destroy=function(t){if(this.result_deselect(t[0].getAttribute("data-option-array-index")))return this.show_search_field_default(),this.is_multiple&&0<this.choices_count()&&this.search_field.val().length<1&&this.results_hide(),t.parents("li").first().remove(),this.search_field_scale()},e.prototype.results_reset=function(){if(this.reset_single_select_options(),this.form_field.options[0].selected=!0,this.single_set_selected_text(),this.show_search_field_default(),this.results_reset_cleanup(),this.form_field_jq.trigger("change"),this.active_field)return this.results_hide()},e.prototype.results_reset_cleanup=function(){return this.current_selectedIndex=this.form_field.selectedIndex,this.selected_item.find("abbr").remove()},e.prototype.result_select=function(t){var e,i;if(this.result_highlight)return e=this.result_highlight,this.result_clear_highlight(),this.is_multiple&&this.max_selected_options<=this.choices_count()?(this.form_field_jq.trigger("chosen:maxselected",{chosen:this}),!1):(this.is_multiple?e.removeClass("active-result"):this.reset_single_select_options(),(i=this.results_data[e[0].getAttribute("data-option-array-index")]).selected=!0,this.form_field.options[i.options_index].selected=!0,this.selected_option_count=null,this.is_multiple?this.choice_build(i):this.single_set_selected_text(i.text),(t.metaKey||t.ctrlKey)&&this.is_multiple||this.results_hide(),this.search_field.val(""),(this.is_multiple||this.form_field.selectedIndex!==this.current_selectedIndex)&&this.form_field_jq.trigger("change",{selected:this.form_field.options[i.options_index].value}),this.current_selectedIndex=this.form_field.selectedIndex,this.search_field_scale())},e.prototype.single_set_selected_text=function(t){return null==t&&(t=this.default_text),t===this.default_text?this.selected_item.addClass("chosen-default"):(this.single_deselect_control_build(),this.selected_item.removeClass("chosen-default")),this.selected_item.find("span").attr("title",t).text(t)},e.prototype.result_deselect=function(t){var e;return e=this.results_data[t],!this.form_field.options[e.options_index].disabled&&(e.selected=!1,this.form_field.options[e.options_index].selected=!1,this.selected_option_count=null,this.result_clear_highlight(),this.results_showing&&this.winnow_results(),this.form_field_jq.trigger("change",{deselected:this.form_field.options[e.options_index].value}),this.search_field_scale(),!0)},e.prototype.single_deselect_control_build=function(){if(this.allow_single_deselect)return this.selected_item.find("abbr").length||this.selected_item.find("span").first().after('<abbr class="search-choice-close"></abbr>'),this.selected_item.addClass("chosen-single-with-deselect")},e.prototype.get_search_text=function(){return this.search_field.val()===this.default_text?"":l("<div/>").text(l.trim(this.search_field.val())).html()},e.prototype.winnow_results_set_highlight=function(t){var e,i;if(null!=(e=(i=this.is_multiple?[]:this.search_results.find(".result-selected.active-result")).length?i.first():this.search_results.find(".active-result").first()))return this.result_do_highlight(e,t)},e.prototype.no_results=function(t){var e;return(e=l('<li class="no-results">'+this.results_none_found+' "<span></span>"</li>')).find("span").first().html(t),this.search_results.append(e),this.form_field_jq.trigger("chosen:no_results",{chosen:this})},e.prototype.no_results_clear=function(){return this.search_results.find(".no-results").remove()},e.prototype.keydown_arrow=function(){var t;return this.results_showing&&this.result_highlight?(t=this.result_highlight.nextAll("li.active-result").first())?this.result_do_highlight(t):void 0:this.results_show()},e.prototype.keyup_arrow=function(){var t;return this.results_showing||this.is_multiple?this.result_highlight?(t=this.result_highlight.prevAll("li.active-result")).length?this.result_do_highlight(t.first()):(0<this.choices_count()&&this.results_hide(),this.result_clear_highlight()):void 0:this.results_show()},e.prototype.keydown_backstroke=function(){var t;return this.pending_backstroke?(this.choice_destroy(this.pending_backstroke.find("a").first()),this.clear_backstroke()):(t=this.search_container.siblings("li.search-choice").last()).length&&!t.hasClass("search-choice-disabled")?(this.pending_backstroke=t,this.single_backstroke_delete?this.keydown_backstroke():this.pending_backstroke.addClass("search-choice-focus")):void 0},e.prototype.clear_backstroke=function(){return this.pending_backstroke&&this.pending_backstroke.removeClass("search-choice-focus"),this.pending_backstroke=null},e.prototype.keydown_checker=function(t){var e,i;switch(e=null!=(i=t.which)?i:t.keyCode,this.search_field_scale(),8!==e&&this.pending_backstroke&&this.clear_backstroke(),e){case 8:this.backstroke_length=this.search_field.val().length;break;case 9:this.results_showing&&!this.is_multiple&&this.result_select(t),this.mouse_on_container=!1;break;case 13:t.preventDefault();break;case 38:t.preventDefault(),this.keyup_arrow();break;case 40:t.preventDefault(),this.keydown_arrow()}},e.prototype.search_field_scale=function(){var t,e,i,s,o,a,r,n;if(this.is_multiple){for(s="position:absolute; left: -1000px; top: -1000px; display:none;",r=a=0,n=(o=["font-size","font-style","font-weight","font-family","line-height","text-transform","letter-spacing"]).length;r<n;r++)s+=(i=o[r])+":"+this.search_field.css(i)+";";return(t=l("<div />",{style:s})).text(this.search_field.val()),l("body").append(t),a=t.width()+25,t.remove(),(e=this.container.outerWidth())-10<a&&(a=e-10),this.search_field.css({width:a+"px"})}},e}()}).call(this)}),function(t,e){"object"==typeof exports?module.exports=e():"function"==typeof define&&(define.amd||define.cmd)?define("lib/zui.datagrid.min",[],e):t.eventUtil=e()}(this,function(){var t;t=function(u){function e(t){var e=t||window.event,i=m.call(arguments,1),s=0,o=0,a=0,r=0,n=0,l=0;if((t=u.event.fix(e)).type="mousewheel","detail"in e&&(a=-1*e.detail),"wheelDelta"in e&&(a=e.wheelDelta),"wheelDeltaY"in e&&(a=e.wheelDeltaY),"wheelDeltaX"in e&&(o=-1*e.wheelDeltaX),"axis"in e&&e.axis===e.HORIZONTAL_AXIS&&(o=-1*a,a=0),s=0===a?o:a,"deltaY"in e&&(s=a=-1*e.deltaY),"deltaX"in e&&(o=e.deltaX,0===a&&(s=-1*o)),0!==a||0!==o){if(1===e.deltaMode){var c=u.data(this,"mousewheel-line-height");s*=c,a*=c,o*=c}else if(2===e.deltaMode){var d=u.data(this,"mousewheel-page-height");s*=d,a*=d,o*=d}if(r=Math.max(Math.abs(a),Math.abs(o)),(!g||r<g)&&(_(e,g=r)&&(g/=40)),_(e,r)&&(s/=40,o/=40,a/=40),s=Math[1<=s?"floor":"ceil"](s/g),o=Math[1<=o?"floor":"ceil"](o/g),a=Math[1<=a?"floor":"ceil"](a/g),v.settings.normalizeOffset&&this.getBoundingClientRect){var h=this.getBoundingClientRect();n=t.clientX-h.left,l=t.clientY-h.top}return t.deltaX=o,t.deltaY=a,t.deltaFactor=g,t.offsetX=n,t.offsetY=l,t.deltaMode=0,i.unshift(t,s,o,a),f&&clearTimeout(f),f=setTimeout(p,200),(u.event.dispatch||u.event.handle).apply(this,i)}}function p(){g=null}function _(t,e){return v.settings.adjustOldDeltas&&"mousewheel"===t.type&&e%120==0}var f,g,t=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],i="onwheel"in document||9<=document.documentMode?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],m=Array.prototype.slice;if(u.event.fixHooks)for(var s=t.length;s;)u.event.fixHooks[t[--s]]=u.event.mouseHooks;var v=u.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var t=i.length;t;)this.addEventListener(i[--t],e,!1);else this.onmousewheel=e;u.data(this,"mousewheel-line-height",v.getLineHeight(this)),u.data(this,"mousewheel-page-height",v.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var t=i.length;t;)this.removeEventListener(i[--t],e,!1);else this.onmousewheel=null;u.removeData(this,"mousewheel-line-height"),u.removeData(this,"mousewheel-page-height")},getLineHeight:function(t){var e=u(t),i=e["offsetParent"in u.fn?"offsetParent":"parent"]();return i.length||(i=u("body")),parseInt(i.css("fontSize"),10)||parseInt(e.css("fontSize"),10)||16},getPageHeight:function(t){return u(t).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};u.fn.extend({mousewheel:function(t){return t?this.bind("mousewheel",t):this.trigger("mousewheel")},unmousewheel:function(t){return this.unbind("mousewheel",t)}})},"function"==typeof define&&define.amd?define("lib/zui.datagrid.min",[],t):"object"==typeof exports?module.exports=t:t(jQuery),function(A,O){"use strict";var g="zui.datagrid",c={date:{getter:function(t,e,i){var s=i.options.defaultDateFormater;return Date.create(t).format(s)},setter:function(t,e,i){if("string"==typeof t){var s=parseInt(t,10);isNaN(s)||(t=s)}return Date.timestamp(t)}}},d={},r={page:0,recTotal:0,recPerPage:10},h={fixedLeftUntil:0,fixedTopUntil:0,order:"asc",sortBy:null,pager:r,selections:{}},m=function(t,r){var n=0,l=r.length,c=0,d={};return A.each(t,function(t,e){var i=typeof e;"number"===i||"number"===i?e+="":"string"!==i&&(e=JSON.stringify(i));for(var s=0,o=0;o<l;++o){var a=r[o];e.includes(a)&&(s=e.startsWith(a)?10:20,d[a]||(d[a]=1,c++))}n+=s}),n=c===l?n:0},v=function(t,e){return t==e?0:t<e?-1:1},u={zh_cn:{errorCannotGetDataFromRemote:"无法从远程服务器（{0}）获取数据。",errorCannotHandleRemoteData:"无法处理远程服务器返回的数据。"},zh_tw:{errorCannotGetDataFromRemote:"無法從遠程服務器（{0}）獲取數據。",errorCannotHandleRemoteData:"無法處理遠程服務器返回的數據。"},en:{errorCannotGetDataFromRemote:"Cannot fetch data from remote server {0}.",errorCannotHandleRemoteData:"Cannot handle the remote data."}},b=function(t,e){var p=this,i=p.$=A(t);p.name=g,p.uuid=A.zui.uuid(),p.id="zui-datagrid-"+p.uuid;var s=(e=A.extend({},b.DEFAULTS,p.$.data(),e)).lang||"zh_cn";p.lang=A.isPlainObject(s)?A.extend(!0,{},u[s.lang||A.zui.clientLang()],s):u[s],e.valueOperator=A.extend({},c,e.valueOperator),e.rowDefaultHeight=e.rowDefaultHeight||30,e.headerHeight=e.headerHeight||e.rowDefaultHeight||30,"number"!=typeof(p.options=e).borderWidth&&(e.borderWidth=1),i.is("table")&&(e.dataSource=A.extend(function(t){var i=[];t.find("thead>tr:first>th").each(function(t){var e=A(this);if(i.push(A.extend({name:t,label:e.html(),html:!0,width:e.outerWidth()},e.data())),e.attr("colspan")&&"1"!==e.attr("colspan"))throw new Erorr("Table th element with colspan attribute is not support.")});var s=[];return t.find("tbody>tr").each(function(){var t=A(this),e={};t.children("td").each(function(t){e[t]=A(this).html()}),s.push(A.extend(e,t.data()))}),{cols:i,array:s,length:s.length}}(p.$),e.dataSource),i.hide(),i=A('<div class="datagrid" id="datagrid-'+p.uuid+'" />').insertAfter(p.$));var _=i.find(".datagrid-container:first");_.length||(_=A('<div class="datagrid-container" />').appendTo(i)),_.css({width:e.width,borderWidth:e.borderWidth});var f=A(document),o=function(o){var s=_.find(".datagrid-scrollbar-"+o);s.length||(s=A('<div class="datagrid-scrollbar datagrid-scrollbar-'+o+'"><div class="bar"></div></div>').appendTo(_));var a,r,n,l,c=!1,d=null,h=".scrollbar"+o+"."+g+"."+p.uuid,u=function(t){if(c){var e=t["h"===o?"pageX":"pageY"];if(d!==e){e=(d=e)-a+r;var i,s=p.layout[o+"Scroll"];i=n?d-a+l:Math.max(0,Math.min(s.space,e-Math.round(s.barSize/2))),"h"===o?p.setScrollbarOffset(i):p.setScrollbarOffset(null,i)}}};s.on("mousedown",function(t){t.preventDefault(),c=!0;var e=p.layout[o+"Scroll"],i="h"===o?"X":"Y";r=t["offset"+i],a=t["page"+i],n=A(t.target).is(".bar"),l=e.offset,n&&(r+=l),u(t),s.addClass("scrolling"),f.on("mouseup"+h,function(t){c=!1,u(t),f.off(h),s.removeClass("scrolling")}).on("mousemove"+h,u)}),p["$"+o+"Scroll"]=s,p["$"+o+"Scrollbar"]=s.find(".bar")};o("h"),o("v");var a=e.mouseWheelFactor;window.navigator.userAgent.match(/Win/i)&&(a*=20),_.on("mousewheel",function(t){p.scroll(p.layout.scrollLeft-Math.round(t.deltaX*a),p.layout.scrollTop-Math.round(t.deltaY*a)),t.preventDefault()}),p.$container=_;var r=i.find(".datagrid-cells:first");if(r.length||(r=A('<div class="datagrid-cells" />').appendTo(_)),r.toggleClass("datagrid-hover-cell",!!e.hoverCell).toggleClass("datagrid-hover-row",!!e.hoverRow).toggleClass("datagrid-hover-col",!!e.hoverCol).toggleClass("datagrid-hover-shadow",!!e.hoverCol),p.$cells=r,p.isFuncConfigs=A.isFunction(e.configs),p.configs=p.isFuncConfigs?e.configs:A.extend({},d,e.configs),p.layout={scrollLeft:0,scrollTop:0},p.configsCache={},p.userConfigs={},p.states=A.extend(!0,{},h,e.states),p.cells=[],p.setPager(p.states.pager),p.setDataSource(e.dataSource),p.render(!0),e.responsive&&(_.width(),_.on("resize",function(){p.layout.cols=null,p.render()})),e.hoverCol&&r.on("mouseenter",".datagrid-cell-head",function(){var t=A(this).data("col");p.$cells.find(".datagrid-cell.hover").removeClass("hover"),p.$cells.find('.datagrid-cell[data-col="'+t+'"]').addClass("hover")}).on("mouseleave",".datagrid-cell-head.hover",function(){p.$cells.find(".datagrid-cell.hover").removeClass("hover")}),e.sortable&&r.on("click",".datagrid-col-sortable",function(){var t=A(this).data("col"),e=p.getColConfig(t),i=p.states.sortBy,s=p.states.order;i!==e.name?(i=e.name,s="desc"):"desc"===s?s="asc":"asc"===s&&(i=""),p.sortBy(i,s)}),e.checkable&&(e.selectable&&A.fn.selectable?(p.selectable=r.selectable(A.extend({selector:".datagrid-row-cell",trigger:e.checkByClickRow?null:".datagrid-row-cell .datagrid-has-checkbox",clickBehavior:"multi",select:function(t){p.checkRow(t.id,!0)},unselect:function(t){p.checkRow(t.id,!1)}},A.isPlainObject(e.selectable)?e.selectable:null)).data("zui.selectable"),r.on("click",".datagrid-cell-head.datagrid-has-checkbox",function(){p.checkRow(A(this).data("row")),p.selectable.syncSelectionsFromClass()})):r.on("click",e.checkByClickRow?".datagrid-row":".datagrid-has-checkbox",function(t){var e=A(this).data("row");(e||A(t.target).closest(".datagrid-has-checkbox").length)&&p.checkRow(e)})),A.fn.pager){var n=p.$.find(".pager");n.length&&(p.pagerObj=n.pager(A.extend({},p.pager,{onPageChange:function(t){p.setPager(t).render()}})).data("zui.pager"))}if(A.fn.searchBox){var l=p.$.find(".search-box");l&&(p.searchbox=l.searchBox({onSearchChange:function(t){p.search(t)}}))}};b.prototype.setPager=function(t,e,i){var s=this;"object"==typeof t&&(i=t.recPerPage,e=t.recTotal,t=t.page);var o=s.pager,a=A.extend({},o);return o||(o=A.extend({},r)),"number"==typeof i&&0<i&&(o.recPerPage=i),"number"==typeof e&&0<=e&&(o.recTotal=e),"number"==typeof t&&0<=t&&(o.page=t),o.totalPage=o.recTotal&&o.recPerPage?Math.ceil(o.recTotal/o.recPerPage):1,o.page=Math.max(0,Math.min(o.page,o.totalPage)),o.pageRecCount=o.recTotal,o.page&&o.recTotal&&(o.page<o.totalPage?o.pageRecCount=o.recPerPage:1<o.page&&(o.pageRecCount=o.recTotal-o.recPerPage*(o.page-1))),o.skip=1<o.page?(o.page-1)*o.recPerPage:0,o.end=o.skip+o.pageRecCount,s.pager=o,a.page===o.page&&a.recTotal===o.recTotal&&a.recPerPage===o.recPerPage||(s.layout.cols=null,s.scroll(0,0)),s},b.prototype.goToPage=function(t){return this.setPager(t).render()},b.prototype.setSearch=function(t){return t!==O&&null!==t||(t=""),this.states.search=A.trim(t),this},b.prototype.search=function(t){return t!==this.states.search&&this.pager.page&&this.setPager(1),this.setSearch(t).render()},b.prototype.setSorter=function(t,e){return e===O&&(e="desc"===this.states.order?"asc":"desc"),this.states.order=e.toLowerCase(),this.states.sortBy=t,this},b.prototype.sortBy=function(t,e){return this.setSorter(t,e).render()},b.prototype.setDataSource=function(t,e){var i=this,s={},o=i.dataSource&&i.dataSource.cols;if(A.isArray(t)?(s.array=t,s.length=t.length,i.setPager("",t.length)):A.isPlainObject(t)?s=A.extend(s,t):"string"==typeof t&&(s.remote=t),!0===s.cache||s.cache===O?(s.cache=[],s.cacheSize=1):"number"==typeof s.cache&&(s.cacheSize=s.cache,s.cache=[]),A.isArray(s.data)?(s.array=s.data,s.length=s.array.length,i.setPager("",s.length),delete s.data):!s.data&&A.isFunction(s.getByIndex)&&i.setPager("",s.length),i.dataSource=s,(e=e||s.cols||o||[]).length)for(var a=0;a<e.length;++a){var r=e[a];"string"==typeof r&&(e[a]={name:r})}e!==o&&(i.layout.cols=null),s.cols=e},b.prototype.filterData=function(t,e){var s=this,i=t,o=null;if(e.search){var a=e.search.replace(/\s{2,}/g," ").split(" ");i=[];for(var r=s.options.searchFunc||m,n=0;n<t.length;++n){var l=t[n],c=r(l,a,n,e,s);c&&(null===o&&(o="number"==typeof c),o&&(l._SCORE=c),i.push(l))}}if(s.setPager(-1,i.length),i.length){var d=e.sortBy||!!o&&"_SCORE";if(d){var h="_SCORE"===d?"DESC":e.order,u=s.getColConfigByName(d),p="desc"===h,_=u&&u.sortFunc||s.options.sortFunc||v;i.sort(function(t,e){var i=_(t[d],e[d],t,e,d,s);return p?-1*i:i})}var f=s.pager;f.page&&(1<f.page&&(f.page,f.recPerPage),i=i.slice(f.skip,f.end))}return i},b.prototype.getFilterParams=function(){var t=this.states;return{page:this.pager.page,recPerPage:this.pager.recPerPage,search:t.search,sortBy:t.sortBy,order:t.order}},b.prototype.loadData=function(e){var a=this;a.loadingId=A.zui.uuid();var i=function(t){return a.$.callComEvent(a,"onLoad",t),e&&e(t)},t=a.getFilterParams(),s=[t.page,t.recPerPage,t.search,t.sortBy,t.order].join("&"),o=a.getData(s);if(o)return i(o);var r=a.dataSource;if(r.array)return o=a.filterData(r.array,t),a.resetData(s,o,a.pager),i(o);if(r.getByIndex)return o=r.getByIndex,a.resetData(s,o),i(o);var n=r.loader,l=r.remote;if(!n&&l&&(n=function(t,o){var e=A.isFunction(l)?l(t,a):{url:l};A.ajax(A.extend({type:"GET",data:t,dataType:"json",success:function(t,e,i){if(r.remoteConverter&&(t=r.remoteConverter(t,e,i,a)),"string"==typeof t&&(t=A.parseJSON(t)),A.isPlainObject(t)&&t.data){var s=t.result||t.status;"success"===s||"ok"===s||200===s?o(t):o(!1,t.message||t.reason||a.lang.errorCannotHandleRemoteData,t)}else o(!1,a.lang.errorCannotHandleRemoteData,t)},error:function(){o(!1,a.lang.errorCannotGetDataFromRemote.format(r.remote))}},e))}),!n)return i(!1);a.renderLoading(!0);var c=a.loadingId;n(t,function(t,e){if(c===a.loadingId){if(a.renderLoading(!1),e)return a.showMessage(e,"danger"),void i(!1);a.resetData(s,t.data,t.pager),i(t.data)}})},b.prototype.getDataItem=function(t,e,i){return"function"==typeof(e=e||this.getData())?e(t,i=i||this.getFilterParams()):e[t]},b.prototype.showMessage=function(t,e,i){var s=this;s.msgerAutoCloseTimer&&(clearTimeout(s.msgerAutoCloseTimer),s.msgerAutoCloseTimer=null);var o=s.$container.find(".datagrid-messager");return t?(e=e||"info",i===O&&(i=5e3),o.length||(o=A('<div class="datagrid-messager" style="display: none"><div class="content"></div><button type="button" class="close">×</button></div>').appendTo(s.$container).on("click",".close",function(){o.slideUp(),s.msgerAutoCloseTimer&&(clearTimeout(s.msgerAutoCloseTimer),s.msgerAutoCloseTimer=null)})),o.attr("class","datagrid-messager bg-"+e).find(".content").text(t),o.slideDown(),void(i&&(s.msgerAutoCloseTimer=setTimeout(function(){o.slideUp(),s.msgerAutoCloseTimer=null},i)))):void o.slideUp()},b.prototype.renderLoading=function(t){t!==O&&(this.states.loading=t);var e=this.$container.find(".datagrid-loading");t?(e.length||(e=A('<div class="datagrid-loading" style="display: none"><div class="content"><i class="icon icon-spin icon-spinner icon-2x"></i><div className="datagrid-loading-message"></div></div></div>').appendTo(this.$container)),e.find(".datagrid-loading-message").text("string"==typeof t?t:""),e.fadeIn()):e.fadeOut()},b.prototype.getData=function(t){var e=this.dataSource,i=null;if(t&&t!==e.dataId){if(e.cache&&e.cache.length)for(var s=e.cache.length-1;0<=s;--s){var o=e.cache[s];if(o.id===t){e.dataId=t,e.data=o.data,this.setPager(o.pager),i=o.data;break}}}else i=e.data;return i},b.prototype.resetData=function(t,e,i){var s=this.dataSource;if(s.dataId=t,s.data=e,s.cache){for(var o=s.cache.length-1;0<o;--o){if(s.cache[o].id===t){s.cache.splice(o,1);break}}for(s.cache.push({id:t,data:e,pager:A.extend({},i)});s.cache.length>s.cacheSize;)s.cache.shift()}i&&this.setPager(i)},b.prototype.getRowLayout=function(t){var e=this.layout;if(0===t)return{top:0,height:e.headerHeight};var i=e.rowHeight;return{height:i,top:e.headerHeight+(1<t?(t-1)*i:0)+t*e.borderWidth}},b.prototype.updateLayout=function(){var t=this,e=t.options,i=t.layout,s=(t.data,t.pager),o=s.pageRecCount,a=t.$container,r=a.width(),n=t.dataSource;if(!n.cols.length&&o&&A.each(t.getDataItem(0),function(t){n.cols.push({name:t})}),!i.cols){for(var l,c,d=n.cols,h=e.colAutoMinWidth,u=e.colAutoDefaultWidth,p=0,_=0,f=e.rowIndexWidth,g=[{left:0,width:e.showRowIndex?"auto"===f?8*(o+t.pager.skip+"").length+18:f:0}],m=0,v=g[0].width,b=!1,y=0,w=0,x=0;x<d.length;++x){var C=d[x];C&&((c=C.width)&&"auto"!==c||(c=.1),l={left:0},1<=c?(C.minWidth!==O&&(c=Math.max(c,C.minWidth)),v+=l.width=c):(C.minWidth===O&&(C.minWidth=h),p+=l.grow=c,_+=C.minWidth,y<=l.grow&&(y=l.grow,b=x+1)),l.minWidth=C.minWidth,!w&&C.checkbox&&(w=x+1,l.checkbox=!0),g.push(l))}e.checkable&&!w&&(g[0].checkbox=!0,"auto"===f&&(g[0].width+=30,v+=30));for(var k=r-v,T=k<_,S=g.length,I=0;I<S;++I){if((c=(l=g[I]).width)||0===c||(c=T?u*l.grow*10:k*l.grow/p,c=Math.floor(Math.max(l.minWidth,c)),l.width=c),0<I){var D=g[I-1];l.left=D.left+D.width}m+=c}var E=r-m;b&&0<E&&(g[b].width+=E,m+=E),i.width=m,i.cols=g}i.containerWidth=r,i.rowHeight=e.rowDefaultHeight,i.borderWidth=e.borderWidth,i.headerHeight=e.showHeader?e.headerHeight:0,i.rowsLength=o+1,i.colsLength=i.cols.length,i.height=i.headerHeight+o*(i.rowHeight+i.borderWidth),i.spanMap={};var M=e.height;"page"===M&&(M=i.headerHeight+t.pager.recPerPage*(i.rowHeight+i.borderWidth)),a.css("height",M),i.containerHeight=M,i.vScrollSpare=i.height-i.containerHeight,i.hScrollSpare=i.width-i.containerWidth,t.layout=i;var R=!!s.page||e.partialRendering;return"auto"===R&&(R=i.height>2*i.containerHeight),i.partialRendering=R,i},b.prototype.getCell=function(t,e){var i,s,o=this,a=o.getCellConfig(t,e),r=0<e?o.dataSource.cols[e-1]:null,n={rowIndex:t,colIndex:e,config:a,checked:o.isRowChecked(a.rowId)};if(0===e){i="index";var l=0<t?o.pager.skip+t:"";s=a.label!==O?a.label:l}else 0===t?(i="head",s=a.label!==O?a.label:a.name!==O?a.name:e):(i="cell",s=a.data&&a.data[o.options.dataItemIsArray?e:r.name]);if(0<t){var c=o.options.valueOperator,d=a.valueType,h=a.valueOperator||(c&&d?c[d]:null);h&&h.getter&&(s=h.getter(s,n,o))}n.value=s,n.type=i;var u=o.layout.spanMap;if(u[a.id]||a.hidden)n.hidden=!0;else if(a.colspan&&1<a.colspan||a.rowspan&&1<a.rowspan){for(var p=t+(a.rowspan||1),_=e+(a.colspan||1),f=t;f<p;++f)for(var g=e;g<_;++g)f===t&&g===e||(u["R"+f+"C"+g]=a.id);a.span=!0}return n},b.prototype.getRowConfig=function(t){var e=this,i="R"+t,s=e.configsCache[i];s||(s=A.extend({},e.isFuncConfigs?e.configs(i):e.configs[i],e.userConfigs[i]),e.configsCache[i]=s);var o=0<t?e.getDataItem(t-1):null;i=(s.data=o)&&(o.rowId||o.id);return s.rowId=i!==O?i:0===t?"#header":t,s},b.prototype.getColConfigByName=function(t){for(var e=this.dataSource.cols,i=0;i<e.length;++i)if(e[i].name===t)return this.getColConfig(i+1);return null},b.prototype.getColConfig=function(t){var e=this,i="C"+t,s=null;return s||(s=A.extend({valueType:"string"},0<t?e.dataSource.cols[t-1]:null,e.layout.cols?e.layout.cols[t]:null,e.isFuncConfigs?e.configs(i):e.configs[i],e.userConfigs[i])),s},b.prototype.getCellConfig=function(t,e){var i=this,s="R"+t+"C"+e,o=null;return o||(o=A.extend({id:s},i.getColConfig(e),i.getRowConfig(t),i.isFuncConfigs?i.configs(s):i.configs[s],i.userConfigs[s])),o},b.prototype.isRowChecked=function(t){return!!this.states.selections[t]},b.prototype.checkRow=function(t,e){var i=this,s=i.states.selections,o=i.getRowConfig(t),a=o.rowId;if(e===O&&(e=!s[a]),s[a]!==e){if(e?s[a]=o:(delete s[a],0<t&&s["#header"]&&(delete s["#header"],i.renderRow(0))),i.renderRow(t),0===t&&i.layout.rowsLength<500)for(var r=1;r<i.layout.rowsLength;++r)i.checkRow(r,e);return i.renderFixeds(),e}},b.prototype.getCheckItems=function(){var e=this.states.selections,i=[];return e&&A.each(e,function(t){i.push(e[t].data)}),i},b.prototype.renderCell=function(t,e,i){var s=this,o=s.options,a=s.getCell(t,e),r=a.config;if(!a.hidden){var n=r.checkbox,l=[s.id,"cell",t,e].join("-"),c=A("#"+l);if(!c.length&&(i=i||A("#"+s.id+"-row-"+t),(c=(o.cellCreator?o.cellCreator(a,s):A('<div class="datagrid-cell" />')).appendTo(i)).attr({id:l,"data-type":a.type,"data-col":a.colIndex,"data-row":a.rowIndex}).toggleClass("datagrid-cell-head",0===t).toggleClass("datagrid-cell-cell","cell"===a.type).toggleClass("datagrid-cell-index",0===e),n)){var d=c.find(".datagrid-checkbox");d.length||(d=A('<div class="checkbox-primary datagrid-checkbox"><label></label></div>').prependTo(c.addClass("datagrid-has-checkbox"))),c.append('<span class="content"></span>')}var h=o.borderWidth,u=s.layout,p=u.colsLength,_={top:h?-h:0,bottom:h?-h:0,left:h?r.left-h:r.left,width:h?r.width+(p-1===e?2:1)*h:r.width,borderWidth:h};if(r.span&&(r.rowspan&&1<r.rowspan&&(_.bottom-=(r.rowspan-1)*(u.rowHeight+h)),r.colspan&&1<r.colspan))for(var f=e+r.colspan,g=e+1;g<f;++g){var m=s.getCell(t,g);_.width+=m.config.width}var v=r.style;A.isFunction(v)&&(v=v(a,_,s));var b=A.extend({},v,_);if(c.css(b).toggleClass("datagrid-cell-span",!!r.span),o.cellFormator)o.cellFormator(c,a,s);else(n?c.find(".content"):c)[a.config.html?"html":"text"](a.value),r.className&&c.addClass(r.className);if(0<e&&0===t&&o.sortable&&!1!==r.sort){var y=!1;r.name===s.states.sortBy&&(y="desc"===s.states.order?"down":"up");var w=c.find(".datagrid-sorter");w.length||(w=A('<div class="datagrid-sorter"><i class="icon icon-sort"></i></div>').appendTo(c),c.addClass("datagrid-col-sortable")),w.toggleClass("datagrid-sort-up","up"===y).toggleClass("datagrid-sort-down","down"===y)}return n&&(c.find(".datagrid-checkbox").toggleClass("checked",a.checked),i.toggleClass("active",a.checked)),c}},b.prototype.renderRow=function(t){var e=this,i=e.layout,s=e.options,o=e.getRowLayout(t),a=i.colsLength,r=e.id+"-row-"+t,n=A("#"+r);n.length?i.partialRendering&&n.css("top",o.top-i.scrollTop):(n=(s.rowCreator?s.rowCreator(t,e):A('<div class="datagrid-row" />')).appendTo(e.$cells)).attr({id:r,"data-row":t,"data-id":t}).css({top:i.partialRendering?o.top-i.scrollTop:o.top,height:o.height}).toggleClass("datagrid-row-head",0===t).toggleClass("datagrid-row-cell",0!==t);for(var l=0;l<a;++l)e.renderCell(t,l,n);return n},b.prototype.renderData=function(){var t=this,e=t.layout;e.cols||t.updateLayout();var i=1,s=e.rowsLength-1;if(e.partialRendering){var o=e.rowHeight+e.borderWidth;i=Math.min(s,Math.max(1,Math.floor((e.scrollTop-e.headerHeight)/o))),s=Math.min(s,Math.max(1,Math.ceil((e.scrollTop+e.containerHeight-e.headerHeight)/o))),t.$cells.find(".datagrid-row").each(function(){var t=A(this),e=t.data("row");0<e&&!t.hasClass("datagrid-fixed")&&(e<i||s<e)&&t.remove()})}t.options.showHeader&&t.renderRow(0);for(var a=i;a<=s;++a)t.renderRow(a);if(e.vScrollSpare){var r=t.states,n=r.fixedTopUntil,l=r.fixedBottomFrom;if("number"==typeof n&&0<n&&n<i)for(a=1;a<=n;++a)t.renderRow(a);if("number"==typeof l&&0<l&&s<l)for(a=l;a<=e.rowsLength-1;++a)t.renderRow(a)}t.pagerObj&&t.pagerObj.set(t.pager)},b.prototype.render=function(t){var i=this,e=i.options;return!t&&e.renderDelay?(i.renderDelayTimer&&clearTimeout(i.renderDelayTimer),i.renderDelayTimer=setTimeout(function(){i.render(!0)},e.renderDelay)):(i.renderDelayTimer&&(clearTimeout(i.renderDelayTimer),i.renderDelayTimer=null),i.loadData(function(t){var e=i.updateLayout();i.$cells.css({width:e.width,height:e.partialRendering?e.containerHeight:i.layout.height}),i.renderData(),i.renderScrolls(),i.renderFixeds(),i.$.callComEvent(i,"onRender")})),i},b.prototype.setScrollbarOffset=function(t,e){var i=this.layout,s=i.scrollLeft,o=i.scrollTop;if("number"==typeof t){var a=i.hScroll;a.offset!==t&&(s=Math.round(t*i.hScrollSpare/a.space))}if("number"==typeof e){var r=i.vScroll;r.offset!==e&&(o=Math.round(e*i.vScrollSpare/r.space))}this.scroll(s,o)},b.prototype.renderScrolls=function(){var t=this,e=t.layout,i=e.vScrollSpare,s=e.hScrollSpare,o=0<i,a=0<s;if(t.$vScroll.toggle(o),t.$hScroll.toggle(a),e.scrollLeft=a?Math.max(0,Math.min(s,e.scrollLeft)):0,e.scrollTop=o?Math.max(0,Math.min(i,e.scrollTop)):0,o){var r=t.$vScrollbar,n=e.containerHeight/e.height,l=Math.max(20,Math.floor(n*e.containerHeight)),c=(u=e.containerHeight-l)/i,d=Math.round(e.scrollTop*c);e.vScroll={space:u,size:i,scale:c,barSize:l,offset:d};var h={height:l,top:d};r.css(h)}if(a){r=t.$hScrollbar,n=e.containerWidth/e.width,l=Math.max(20,Math.floor(n*e.containerWidth));var u=e.containerWidth-l;h={width:l,left:d=Math.round(e.scrollLeft*u/s)};e.hScroll={offset:d,space:u,size:s,barSize:l},r.css(h)}t.$cells.css({top:e.partialRendering?0:-e.scrollTop,left:-e.scrollLeft})},b.prototype.scroll=function(t,e,i){var s=this,o=new Date,a=s.options.scrollDelay;if(a){if(!i&&s.lastScrollTime&&o-s.lastScrollTime<a)return s.scrollDelayTimer&&clearTimeout(s.scrollDelayTimer),void(s.scrollDelayTimer=setTimeout(function(){s.scroll(t,e)},a-(o-s.lastScrollTime)));s.scrollDelayTimer&&(clearTimeout(s.scrollDelayTimer),s.scrollDelayTimer=null),s.lastScrollTime=o}var r=s.layout,n=!1,l=!1;"number"==typeof t&&((t=Math.max(0,Math.min(t,r.width-r.containerWidth)))!==r.scrollLeft&&(n=!0,r.scrollLeft=t)),"number"==typeof e&&((e=Math.max(0,Math.min(e,r.height-r.containerHeight)))!==r.scrollTop&&(l=!0,r.scrollTop=e)),l&&r.partialRendering&&s.renderData(),(n||l)&&(s.renderScrolls(),s.renderFixeds()),s.$.callComEvent(s,"onScroll",[t,e,{vScrolled:l,hScrolled:n}])},b.prototype.renderFixeds=function(){var t=this,e=t.states,i=t.layout;if(t.$cells.find(".datagrid-fixed").removeClass("datagrid-fixed"),t.$cells.find(".datagrid-fixed-edge-top").removeClass("datagrid-fixed-edge-top"),t.$cells.find(".datagrid-fixed-edge-bottom").removeClass("datagrid-fixed-edge-bottom"),t.$cells.find(".datagrid-fixed-edge-left").removeClass("datagrid-fixed-edge-left"),t.$cells.find(".datagrid-fixed-edge-right").removeClass("datagrid-fixed-edge-right"),i.vScrollSpare){var s=e.fixedTopUntil;if("number"==typeof s&&-1<s){s=Math.min(s,i.rowsLength);for(var o=0;o<=s;++o){var a=t.getRowLayout(o),r=A("#"+t.id+"-row-"+o),n=i.partialRendering?a.top:a.top+i.scrollTop;r.addClass("datagrid-fixed").css("top",n),o===s&&i.scrollTop&&r.addClass("datagrid-fixed-edge-top")}}else s=-1;var l=e.fixedBottomFrom;if("number"==typeof l&&-1<l)for(o=l=Math.max(-1<s?s+1:1,Math.min(l,i.rowsLength));o<i.rowsLength;++o){a=t.getRowLayout(o),r=A("#"+t.id+"-row-"+o),n=i.partialRendering?a.top-i.vScrollSpare:a.top-i.vScrollSpare+i.scrollTop;r.addClass("datagrid-fixed").css("top",n),o===l&&i.scrollTop<i.vScrollSpare&&r.addClass("datagrid-fixed-edge-bottom")}}if(i.hScrollSpare){var c=e.fixedLeftUntil;if("number"==typeof c&&-1<c){c=Math.min(c,i.colsLength);for(o=0;o<=c;++o){var d=i.cols[o],h=t.$cells.find('.datagrid-cell[data-col="'+o+'"]'),u=d.left+i.scrollLeft-i.borderWidth;h.addClass("datagrid-fixed").css("left",u),o===c&&i.scrollLeft&&h.addClass("datagrid-fixed-edge-left")}}else c=-1;var p=e.fixedRightFrom;if("number"==typeof p&&-1<p)for(o=p=Math.max(-1<c?c+1:1,Math.min(p,i.colsLength));o<i.colsLength;++o){d=i.cols[o],h=t.$cells.find('.datagrid-cell[data-col="'+o+'"]'),u=d.left-i.hScrollSpare+i.scrollLeft;h.addClass("datagrid-fixed").css("left",u),o===p&&i.scrollLeft<i.hScrollSpare&&h.addClass("datagrid-fixed-edge-right")}}},b.DEFAULTS={width:"auto",height:400,rowDefaultHeight:36,colAutoDefaultWidth:80,colAutoMinWidth:50,showHeader:!0,headerHeight:36,showRowIndex:!0,rowIndexWidth:"auto",borderWidth:1,hoverRow:!0,hoverCol:!0,hoverCell:!1,responsive:!0,defaultDateFormater:"yyyy-MM-dd hh:mm",partialRendering:"auto",scrollDelay:0,renderDelay:100,checkByClickRow:!0,selectable:!0,mouseWheelFactor:1},A.fn.datagrid=function(s){return this.each(function(){var t=A(this),e=t.data(g),i="object"==typeof s&&s;e||t.data(g,e=new b(this,i)),"string"==typeof s&&e[s]()})},b.NAME=g,A.fn.datagrid.Constructor=b,A(function(){A('[data-ride="datagrid"]').datagrid()})}(jQuery,void 0)}),function(t,e){"object"==typeof exports?module.exports=e():"function"==typeof define&&(define.amd||define.cmd)?define("lib/zui.board.min",[],e):t.eventUtil=e()}(this,function(){!function(a){"use strict";if(!a.fn.droppable)throw new Error("Droppable requires for boards");var o=function(t,e){this.$=a(t),this.options=this.getOptions(e),this.getLang(),this.init()};o.DEFAULTS={langs:{zh_cn:{append2end:"移动到末尾"},zh_tw:{append2end:"移动到末尾"},en:{append2end:"Move to the end."}}},o.prototype.getOptions=function(t){return a.extend({lang:a.zui.clientLang()},o.DEFAULTS,this.$.data(),t)},o.prototype.getLang=function(){var t=this.options;this.lang=t.langs[t.lang]||t.langs[o.DEFAULTS.lang]},o.prototype.init=function(){var e=1,i=this.lang;this.$.find('.board-item:not(".disable-drop"), .board:not(".disable-drop")').each(function(){var t=a(this);t.attr("id")?t.attr("data-id",t.attr("id")):t.attr("data-id")||t.attr("data-id","board"+e++),t.hasClass("board")&&t.find(".board-list").append('<div class="board-item board-item-empty"><i class="icon-plus"></i> {append2end}</div>'.format(i)).append('<div class="board-item board-item-shadow"></div>'.format(i))}),this.bind()},o.prototype.bind=function(t){var o=this.$,i=this.options;o.droppable(a.extend({before:i.before,target:'.board-item:not(".disable-drop, .board-item-shadow")',flex:!0,selector:'.board-item:not(".disable-drop, .board-item-shadow")',start:function(t){o.addClass("dragging").find(".board-item-shadow").height(t.element.outerHeight())},drag:function(t){if(o.find(".board.drop-in-empty").removeClass("drop-in-empty"),t.isIn){var e=t.target.closest(".board").addClass("drop-in"),i=e.find(".board-item-shadow"),s=t.target;o.addClass("drop-in").find(".board.drop-in").not(e).removeClass("drop-in"),i.insertBefore(s),e.toggleClass("drop-in-empty",s.hasClass("board-item-empty"))}},drop:function(t){var e;t.isNew&&(a.isFunction(i.drop)&&(e=i.drop(t)),!1!==e&&t.element.insertBefore(t.target))},finish:function(){o.removeClass("dragging").removeClass("drop-in").find(".board.drop-in").removeClass("drop-in")}},i.droppable))},a.fn.boards=function(s){return this.each(function(){var t=a(this),e=t.data("zui.boards"),i="object"==typeof s&&s;e||t.data("zui.boards",e=new o(this,i)),"string"==typeof s&&e[s]()})},a.fn.boards.Constructor=o}(jQuery)});